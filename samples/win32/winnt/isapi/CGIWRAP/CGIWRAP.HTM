<html>
<title>Internet Server Sample Apps</title>
<h1>Internet Server Sample: CGI Wrapper for ISAPI DLLs</h1>
<body>
This sample shows how to wrap an ISAPI DLL  in a CGI executable, on systems
that cannot use the DLL for some reason.
To use this sample, simply build it by running <I> nmake</I> on the 
makefile provided.
This will create cgiwrap.exe which can be renamed to match the name
of the DLL. For example, to call foo.dll from this wrapper, rename 
cgiwrap.exe to foo.exe
<p>
This sample can also be used to aid in debugging.  If you have a text file that
contains a full http query (for POSTed forms; GET forms are all on the command
line) then you can run this program under a debugger to analyze your sample.
Please keep in mind that this is not the same environment as running as
a service under IIS. Also, this sample, unlike IIS, is single threaded.
<p>
To illustrate the usage, here is an example of calling the ISrvMon sample from
a CGI exe. cgiwrap.exe was renamed to ISrvMon.exe for this purpose. The
following form is identical to the ISrvMon sample, but calls ISrvMon.exe
instead. ISrvMon.DLL should, of course, be available for loading.
<p>
Note that the process information returned by ISrvMon.Dll is now for the
ISrvMon.Exe (CGIWrap) process and not for the INetInfo.Exe (IIS) process.
<p><hr>
<h3>This is a GET operation</h3>
<form action="http:/scripts/SDK/isrvmon.exe" method=get>
<input type="checkbox" name="check1" value="SystemInfo">System Information<p>
<input type="checkbox" name="check2" value="MemoryStatus">Memory Status<p>
<input type="checkbox" name="check3" value="ProcessInfo">Process Information<p>
<input type="submit" value="Do Query">
</form>
<p><hr>
<h3>This is a POST operation</h3>
<form action="http:/scripts/SDK/isrvmon.exe" method=post>
<input type="checkbox" name="check1" value="SystemInfo">System Information<p>
<input type="checkbox" name="check2" value="MemoryStatus">Memory Status<p>
<input type="checkbox" name="check3" value="ProcessInfo">Process Information<p>
<input type="submit" value="Do Query">
</form>
<p><hr>
<a href="http:CgiWrap.c">View Source code</a>
</body>
</html>
