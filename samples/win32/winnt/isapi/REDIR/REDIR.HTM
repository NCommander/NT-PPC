<!doctype html public "-//IETF//DTD HTML//EN">
<HTML>

<HEAD>

<TITLE>Demonstration of redir.dll</TITLE>

<META NAME="GENERATOR" CONTENT="Internet Assistant for Word 1.0Z">
<META NAME="AUTHOR" CONTENT=".">
</HEAD>

<BODY>
<H1 ALIGN="CENTER">REDIR.DLL</H1>
This ISAPI Extension is used to send the client to another page 
and log the transaction. 
<H2>Examples</H2>
<OL>

<LI> <B>Syntax:</B> &lt;A HREF=&quot;redir.dll?target=http://www.volcanocoffee.com/&quot;&gt;<BR>
Come see Volcano Coffee today!&lt;IMG SRC=&quot;volcano.gif&quot ALIGN=&quot;MIDDLE&quot;&gt;&lt;/A&gt;<BR>
<BR>
This would send the user to http://www.volcanocoffee.com/ and give the current
html page 'credit' for the redirection.<BR>
 <B>Demo:</B> <A HREF="/Scripts/SDK/redir.dll?target=http://www.volcanocoffee.com/">
Come see Volcano Coffee today!<IMG SRC="volcano.gif" ALIGN="MIDDLE"></A>
<BR><BR>


<LI> <B>Syntax:</B> &lt;FORM ACTION=&quot;redir.dll&quot;&gt;<BR>
  &lt;SELECT NAME=&quot;Target&quot;&gt;  &lt;!-- Name must be target --&gt;<BR>
      &lt;OPTION VALUE=&quot;http://www.volcanocoffee.com/&quot;&gt;Volcano Coffee<BR>
      &lt;OPTION VALUE=&quot;/some/local/path.htm&quot;&gt;Local Path<BR>
  &lt;/SELECT&gt;<BR>
  &lt;INPUT TYPE=&quot;SUBMIT&quot; VALUE=&quot;Go!&quot;&gt;<BR>
&lt;/FORM&gt;<BR>
<BR>
this presents the user with a drop down box of choices of places
to go.  you can see an example of this on microsoft's home page
<A HREF="http://www.microsoft.com/">http://www.microsoft.com/</A><BR>
 <B>Demo:</B> 
<FORM ACTION="/Scripts/SDK/redir.dll">
  <SELECT NAME="Target">  <!-- Name must be target -->
      <OPTION VALUE="http://www.volcanocoffee.com/">Volcano Coffee (example only, will not work)
      <OPTION VALUE="/">WWWRoot SDK Root
      <OPTION VALUE="/ISAPIsmp.htm">ISAPI Samples
  </SELECT>
  <INPUT TYPE="SUBMIT" VALUE="Go!">
</FORM>
<H2>More Information</H2>
<P>
The local URLs must begin with a '/' char.  This is a requirement of 
HSE_REQ_SEND_URL, which is used to send the file.  When the HSE_REQ_SEND_URL 
is used, the user's current URL becomes something like 
&quot;http://host.company.com/scripts/redir.dll?target=%2FPath%2Fto%2Ffile.htm&quot;.  
If you do not like this behaviour, you can use absolute URLs.  This will force 
redir.dll to use HSE_REQ_SEND_REDIRECT_RESPONSE.  This will cause the user's 
current URL to become something like &quot;http://host.company.com/path/to/file.htm&quot;.

<P>
Running redir.dll either way causes additional data to be written to the 
web server's log file.  The additional data appears in the parameters area
and has the format "rdrRef=URL rdrTgt=URL".  This gives you the ability to scan
for these values in the log file and give credit to advertising pages.  The 
rdrRef value is the HTTP_REFERER value if the client sent it and a dash '-' 
if the client did not send it.  the rdrTgt value is the URL that redir.dll 
sent the client to.


</BODY>

</HTML>
